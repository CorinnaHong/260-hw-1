---
title: "HW1"
author: "Corinna Hong"
date: "January 13, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, load packages, echo = FALSE, message = FALSE, warning = FALSE}

library(tidyverse)
library(janitor)

```

```{r, read in adult data, echo = FALSE, message = FALSE}

adult_organisms <- read_csv("mean_density_adult_organisms.csv")

```

```{r, wrangle adult data, echo = FALSE}

adult_organisms_tidy <- adult_organisms %>% 
  gather(`2009`, `2018`, key = "year", value = "mean_density_per_100m2") %>% 
  arrange(organism, year) %>% 
  select(organism, lagoon, year, mean_density_per_100m2, ci95) # rearranges columns

```

# 1. Mean Density of Adults
</br>
```{r, adult fish graphs, echo = FALSE}

adult_fish <- adult_organisms_tidy %>% 
  filter(grepl('fish', organism)) # find anything with "fish" in organism column and keep it

labels <- c('Coral Trout (fish, predators of adult fishes)' = "Coral Trout", 
            'Spotted Damselfish (fish, eats zooplankton)' = "Spotted Damselfish",
            'Surgeonfish (fish, herbivores)' = "Surgeonfish",
            'Yellow Damselfish (fish, eats zooplankton)' = "Yellow Damselfish") # Rename organisms for facet labels

adult_fish_bar <- ggplot(adult_fish, aes(fill = year, x = lagoon, y = mean_density_per_100m2)) +
  geom_bar(position = "dodge", stat = "identity") + 
  geom_errorbar(aes(ymin = mean_density_per_100m2 + ci95, ymax = mean_density_per_100m2 - ci95), width = 0.3, position=position_dodge(.9)) +  
  labs(x = "Lagoon", y = expression(Mean~Density~(number/"100m^2")), title = "Adult Fish Comparisons") +
  facet_wrap(~ organism, labeller=labeller(organism = labels), scale = "free") + # facet wrap with new labels  scale_y_continuous(expand = c(0,0)) +
  theme_minimal() # or maybe go with classic?

adult_fish_bar # FINALIZE (fix the 100 m^2 problem)

```


```{r, other organisms graph, echo = FALSE}

adult_other <- adult_organisms_tidy %>% 
  filter(!(grepl('fish', organism))) # remonve anything with "fish" from organism column


adult_other_bar <- ggplot(adult_other, aes(fill = year, x = lagoon, y = mean_density_per_100m2)) +
  geom_bar(position = "dodge", stat = "identity") + 
  geom_errorbar(aes(ymin = mean_density_per_100m2 + ci95, ymax = mean_density_per_100m2 - ci95), width = 0.3, position=position_dodge(.9)) +  
  labs(x = "Lagoon", y = expression(Mean~Density~(m^2/"100m^2")), title = "Adult Organisms Comparisons") +
  facet_wrap(~ organism, scale = "free") + # facet wrap with new labels  
  scale_y_continuous(expand = c(0,0)) +
  theme_minimal() # or maybe go with classic?

adult_other_bar # FINALIZE (fix the 100m^2 problem)

```

```{r, read in recruit data, echo = FALSE, message = FALSE}

recruit_organisms <- read_csv("mean_number_new_recruits.csv")

```

```{r, wrangle recruit data, echo = FALSE}

recruit_organisms_tidy <- recruit_organisms %>%
  clean_names() %>% 
  gather(`rarotonga_2009`, `aitutaki_2009`, `rarotonga_2018`, `aitutaki_2018`, key = "lagoon", value = "density") %>% 
  separate(lagoon, into = c ("lagoon","year"), sep = "_") %>% 
  arrange(fish) %>% 
  select (fish, microhabitat, lagoon, year, density, ci)
  
```

